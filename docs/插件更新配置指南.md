# BasePlugin æ’ä»¶æ›´æ–°é…ç½®æŒ‡å—

## ğŸ¯ æ¦‚è¿°

æœ¬æŒ‡å—è¯¦ç»†è¯´æ˜å¦‚ä½•ä¸º BasePlugin æ¨¡æ¿é…ç½®è‡ªåŠ¨æ›´æ–°åŠŸèƒ½ï¼ŒåŒ…æ‹¬å®¢æˆ·ç«¯é…ç½®å’ŒæœåŠ¡å™¨ç«¯å®ç°ã€‚æ’ä»¶æ›´æ–°æœºåˆ¶é‡‡ç”¨åœ¨çº¿æ£€æŸ¥æ¨¡å¼ï¼Œä¸‹è½½åœ°å€ç­‰ä¿¡æ¯ä»æœåŠ¡å™¨åŠ¨æ€è·å–ã€‚

## ğŸ“‹ å®¢æˆ·ç«¯é…ç½®

### 1. æ›´æ–° manifest.json

åœ¨æ‚¨çš„æ’ä»¶ `manifest.json` æ–‡ä»¶ä¸­æ·»åŠ æ›´æ–°é…ç½®ï¼š

```json
{
  "name": "YourPluginName",
  "version": "1.0.0",
  "description": "æ‚¨çš„æ’ä»¶æè¿°",
  "author": "æ‚¨çš„å§“å",
  "email": "your@email.com",
  "website": "https://yourwebsite.com",
  "entry": "YourPlugin.dll",
  "mainClass": "YourPlugin.YourPlugin",
  "minimumHostVersion": "1.0.0",
  "updateInfo": {
    "updateUrl": "https://yourserver.com/api/plugins/YourPluginName/updateInfo.json",
    "checkIntervalHours": 24,
    "autoCheck": true,
    "supportedUpdateModes": ["full", "incremental"],
    "backupBeforeUpdate": true,
    "restartRequired": false,
    "verifySignature": false,
    "publicKeyPath": "public.key"
  },
  "changeLog": [
    {
      "version": "1.0.0",
      "date": "2024-12-24",
      "type": "major",
      "changes": [
        "åˆå§‹ç‰ˆæœ¬å‘å¸ƒ",
        "åŸºç¡€åŠŸèƒ½å®ç°"
      ]
    }
  ],
  "settings": [
    {
      "key": "updateCheckEnabled",
      "type": "boolean",
      "default": true,
      "description": "æ˜¯å¦å¯ç”¨è‡ªåŠ¨æ›´æ–°æ£€æŸ¥"
    }
  ]
}
```

### 2. é…ç½®å­—æ®µè¯¦ç»†è¯´æ˜

#### updateInfo å­—æ®µè§£é‡Š

| å­—æ®µå | ç±»å‹ | å¿…éœ€ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|------|--------|------|
| `updateUrl` | string | âœ… | - | æ›´æ–°æ£€æŸ¥APIçš„å®Œæ•´URLåœ°å€ï¼ˆå¿…é¡»è¿”å›JSONæ ¼å¼çš„æ›´æ–°ä¿¡æ¯ï¼‰ |
| `checkIntervalHours` | number | âŒ | 24 | è‡ªåŠ¨æ£€æŸ¥æ›´æ–°çš„é—´éš”æ—¶é—´ï¼ˆå°æ—¶ï¼‰ |
| `autoCheck` | boolean | âŒ | true | æ˜¯å¦å¯ç”¨è‡ªåŠ¨æ›´æ–°æ£€æŸ¥ |
| `supportedUpdateModes` | array | âŒ | ["full"] | æ”¯æŒçš„æ›´æ–°æ¨¡å¼ï¼šfullï¼ˆå…¨é‡ï¼‰, incrementalï¼ˆå¢é‡ï¼‰ |
| `backupBeforeUpdate` | boolean | âŒ | true | æ›´æ–°å‰æ˜¯å¦è‡ªåŠ¨å¤‡ä»½å½“å‰ç‰ˆæœ¬ |
| `restartRequired` | boolean | âŒ | false | æ›´æ–°å®Œæˆåæ˜¯å¦éœ€è¦é‡å¯åº”ç”¨ç¨‹åº |
| `verifySignature` | boolean | âŒ | false | æ˜¯å¦éªŒè¯æ›´æ–°åŒ…çš„æ•°å­—ç­¾å |
| `publicKeyPath` | string | âŒ | null | æ•°å­—ç­¾åéªŒè¯çš„å…¬é’¥æ–‡ä»¶è·¯å¾„ |

> âš ï¸ **é‡è¦**ï¼š`downloadUrl` ä¸å†åœ¨ manifest.json ä¸­é…ç½®ï¼Œè€Œæ˜¯é€šè¿‡ `updateUrl` è¿”å›çš„åœ¨çº¿JSONåŠ¨æ€è·å–ã€‚

#### æ›´æ–°æ¨¡å¼è¯´æ˜

- **fullï¼ˆå…¨é‡æ›´æ–°ï¼‰**ï¼šä¸‹è½½å®Œæ•´çš„æ’ä»¶åŒ…ï¼Œæ›¿æ¢æ‰€æœ‰æ–‡ä»¶
- **incrementalï¼ˆå¢é‡æ›´æ–°ï¼‰**ï¼šä»…ä¸‹è½½ä¿®æ”¹çš„æ–‡ä»¶ï¼ŒèŠ‚çœå¸¦å®½å’Œæ—¶é—´

## ğŸ–¥ï¸ æœåŠ¡å™¨ç«¯å®ç°

### 1. æ›´æ–°æ£€æŸ¥API

åˆ›å»ºä¸€ä¸ªè¿”å›JSONæ ¼å¼æ›´æ–°ä¿¡æ¯çš„APIç«¯ç‚¹ï¼š

#### è¯·æ±‚æ ¼å¼

```
GET https://yourserver.com/api/plugins/YourPluginName/updateInfo.json
```

> ğŸ’¡ **æ³¨æ„**ï¼šå®¢æˆ·ç«¯ä¼šè‡ªåŠ¨æ·»åŠ æ—¶é—´æˆ³å‚æ•°ï¼ˆå¦‚ `?_t=1234567890`ï¼‰æ¥é˜²æ­¢ç¼“å­˜ã€‚

#### å“åº”æ ¼å¼

æœåŠ¡å™¨å¿…é¡»è¿”å›ä»¥ä¸‹JSONæ ¼å¼çš„å“åº”ï¼š

```json
{
  "latestVersion": "1.1.0",
  "downloadUrl": "https://yourserver.com/downloads/YourPlugin-v1.1.0.zip",
  "updateMode": "full",
  "fileSize": 1048576,
  "fileHash": "sha256:e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",
  "isForced": false,
  "releaseNotes": "ç‰ˆæœ¬ 1.1.0 æ›´æ–°å†…å®¹:\n\næ–°å¢åŠŸèƒ½:\n- æ·»åŠ äº†æ•°æ®å¯¼å‡ºåŠŸèƒ½\n- ä¼˜åŒ–äº†ç•Œé¢å“åº”é€Ÿåº¦\n\nä¿®å¤é—®é¢˜:\n- ä¿®å¤äº†åœ¨æŸäº›æƒ…å†µä¸‹çš„å´©æºƒé—®é¢˜\n- è§£å†³äº†å…¼å®¹æ€§é—®é¢˜",
  "releaseDate": "2024-12-24",
  "minCompatibleVersion": "1.0.0"
}
```

#### é˜²ç¼“å­˜é…ç½®

ä¸ºç¡®ä¿å®¢æˆ·ç«¯æ€»æ˜¯è·å–æœ€æ–°çš„æ›´æ–°ä¿¡æ¯ï¼Œå»ºè®®åœ¨æœåŠ¡å™¨ç«¯è¿›è¡Œä»¥ä¸‹é…ç½®ï¼š

> âš ï¸ **é‡è¦æç¤º**ï¼š
> - **è¯·æ±‚å¤´**ï¼ˆå®¢æˆ·ç«¯å‘é€ï¼‰ï¼š`Cache-Control`, `Pragma`
> - **å“åº”å¤´**ï¼ˆæœåŠ¡å™¨è¿”å›ï¼‰ï¼š`Cache-Control`, `Pragma`, `Expires`
> - å®¢æˆ·ç«¯ä¼šè‡ªåŠ¨åœ¨è¯·æ±‚ä¸­æ·»åŠ é˜²ç¼“å­˜è¯·æ±‚å¤´å’Œæ—¶é—´æˆ³å‚æ•°

##### 1. é™æ€æ–‡ä»¶æœåŠ¡å™¨é…ç½®

**Nginx é…ç½®ç¤ºä¾‹ï¼š**
```nginx
location ~ /updateInfo\.json$ {
    # ç¦ç”¨ç¼“å­˜ï¼ˆå“åº”å¤´ï¼‰
    add_header Cache-Control "no-cache, no-store, must-revalidate";
    add_header Pragma "no-cache";
    add_header Expires "0";
    
    # å…è®¸è·¨åŸŸè¯·æ±‚ï¼ˆå¦‚æœéœ€è¦ï¼‰
    add_header Access-Control-Allow-Origin "*";
}
```

**Apache é…ç½®ç¤ºä¾‹ï¼ˆ.htaccessï¼‰ï¼š**
```apache
<FilesMatch "updateInfo\.json$">
    # è®¾ç½®å“åº”å¤´é˜²æ­¢ç¼“å­˜
    Header set Cache-Control "no-cache, no-store, must-revalidate"
    Header set Pragma "no-cache"
    Header set Expires "0"
</FilesMatch>
```

**IIS é…ç½®ç¤ºä¾‹ï¼ˆweb.configï¼‰ï¼š**
```xml
<configuration>
  <system.webServer>
    <staticContent>
      <clientCache cacheControlMode="DisableCache" />
    </staticContent>
    <httpProtocol>
      <customHeaders>
        <!-- å“åº”å¤´è®¾ç½® -->
        <add name="Cache-Control" value="no-cache, no-store, must-revalidate" />
        <add name="Pragma" value="no-cache" />
        <add name="Expires" value="0" />
      </customHeaders>
    </httpProtocol>
  </system.webServer>
</configuration>
```

##### 2. åŠ¨æ€APIé˜²ç¼“å­˜

å¦‚æœä½¿ç”¨åŠ¨æ€APIï¼Œåœ¨å“åº”ä¸­è®¾ç½®ç›¸åº”çš„HTTPå¤´ï¼š

**ASP.NET Core ç¤ºä¾‹ï¼š**
```csharp
[HttpGet("{pluginName}/updateInfo.json")]
public async Task<IActionResult> GetUpdateInfo(string pluginName)
{
    // è®¾ç½®é˜²ç¼“å­˜å“åº”å¤´
    Response.Headers.Add("Cache-Control", "no-cache, no-store, must-revalidate");
    Response.Headers.Add("Pragma", "no-cache");
    Response.Headers.Add("Expires", "0");
    
    // ... å…¶ä»–ä»£ç 
}
```

**Node.js/Express ç¤ºä¾‹ï¼š**
```javascript
app.get('/api/plugins/:pluginName/updateInfo.json', (req, res) => {
    // è®¾ç½®é˜²ç¼“å­˜å“åº”å¤´
    res.set({
        'Cache-Control': 'no-cache, no-store, must-revalidate',
        'Pragma': 'no-cache',
        'Expires': '0'
    });
    
    // ... è¿”å›æ›´æ–°ä¿¡æ¯
});
```

##### 3. å®¢æˆ·ç«¯è¯·æ±‚ç¤ºä¾‹

å®¢æˆ·ç«¯ä¼šè‡ªåŠ¨å‘é€ä»¥ä¸‹æ ¼å¼çš„è¯·æ±‚ï¼š

```
GET https://yourserver.com/api/plugins/YourPluginName/updateInfo.json?_t=1703424000000 HTTP/1.1
Host: yourserver.com
User-Agent: DTI-Tool-Plugin-Updater/1.0
Accept: application/json
Cache-Control: no-cache, no-store, must-revalidate
Pragma: no-cache
```

#### å“åº”å­—æ®µè¯´æ˜

| å­—æ®µå | ç±»å‹ | å¿…éœ€ | è¯´æ˜ |
|--------|------|------|------|
| `latestVersion` | string | âœ… | æœ€æ–°å¯ç”¨ç‰ˆæœ¬å· |
| `downloadUrl` | string | âœ… | æ›´æ–°åŒ…ä¸‹è½½é“¾æ¥ï¼ˆå¯ä»¥æ˜¯ä»»æ„æœ‰æ•ˆçš„HTTP/HTTPSåœ°å€ï¼‰ |
| `updateMode` | string | âŒ | æ›´æ–°æ¨¡å¼ï¼š"full" æˆ– "incremental" |
| `fileSize` | number | âŒ | æ›´æ–°åŒ…æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰ |
| `fileHash` | string | âŒ | æ–‡ä»¶å®Œæ•´æ€§æ ¡éªŒå“ˆå¸Œå€¼ |
| `isForced` | boolean | âŒ | æ˜¯å¦å¼ºåˆ¶æ›´æ–°ï¼ˆä¸å…è®¸è·³è¿‡ï¼‰ |
| `releaseNotes` | string | âŒ | ç‰ˆæœ¬æ›´æ–°è¯´æ˜ï¼Œæ”¯æŒæ¢è¡Œç¬¦ |
| `releaseDate` | string | âŒ | å‘å¸ƒæ—¥æœŸï¼ˆYYYY-MM-DDæ ¼å¼ï¼‰ |
| `minCompatibleVersion` | string | âŒ | æœ€ä½å…¼å®¹ç‰ˆæœ¬ |

### 2. é™æ€JSONæ–‡ä»¶ç¤ºä¾‹

å¦‚æœä½¿ç”¨é™æ€æ–‡ä»¶æœåŠ¡ï¼Œå¯ä»¥ç›´æ¥åˆ›å»ºä¸€ä¸ª `updateInfo.json` æ–‡ä»¶ï¼š

```json
{
  "latestVersion": "1.1.0",
  "downloadUrl": "https://github.com/youruser/yourplugin/releases/download/v1.1.0/YourPlugin-v1.1.0.zip",
  "updateMode": "full",
  "fileSize": 2097152,
  "fileHash": "sha256:abcdef1234567890abcdef1234567890abcdef1234567890abcdef1234567890",
  "isForced": false,
  "releaseNotes": "ç‰ˆæœ¬ 1.1.0 æ›´æ–°å†…å®¹:\n\nâœ¨ æ–°å¢åŠŸèƒ½:\n- æ·»åŠ æ•°æ®å¯¼å‡ºåŠŸèƒ½\n- æ–°å¢æ‰¹é‡å¤„ç†é€‰é¡¹\n- ä¼˜åŒ–ç•Œé¢å“åº”é€Ÿåº¦\n\nğŸ› ä¿®å¤é—®é¢˜:\n- ä¿®å¤åœ¨æŸäº›æƒ…å†µä¸‹çš„å´©æºƒé—®é¢˜\n- è§£å†³ä¸Office 2019çš„å…¼å®¹æ€§é—®é¢˜\n- ä¿®å¤å†…å­˜æ³„æ¼é—®é¢˜\n\nâš¡ æ€§èƒ½ä¼˜åŒ–:\n- æå‡å¤§æ•°æ®é‡å¤„ç†é€Ÿåº¦30%\n- å‡å°‘å†…å­˜å ç”¨\n- ä¼˜åŒ–å¯åŠ¨æ—¶é—´",
  "releaseDate": "2024-12-24",
  "minCompatibleVersion": "1.0.0"
}
```

### 3. åŠ¨æ€APIå®ç°ï¼ˆASP.NET Core ç¤ºä¾‹ï¼‰

```csharp
[ApiController]
[Route("api/plugins")]
public class PluginUpdateController : ControllerBase
{
    private readonly IPluginService _pluginService;
    
    public PluginUpdateController(IPluginService pluginService)
    {
        _pluginService = pluginService;
    }
    
    [HttpGet("{pluginName}/updateInfo.json")]
    public async Task<IActionResult> GetUpdateInfo(string pluginName)
    {
        try
        {
            // è·å–æ’ä»¶çš„æœ€æ–°ç‰ˆæœ¬ä¿¡æ¯
            var latestVersion = await _pluginService.GetLatestVersionAsync(pluginName);
            
            if (latestVersion == null)
            {
                return NotFound();
            }
            
            var response = new
            {
                latestVersion = latestVersion.Version,
                downloadUrl = latestVersion.DownloadUrl, // å¯ä»¥æ˜¯ä»»æ„URL
                updateMode = latestVersion.UpdateMode,
                fileSize = latestVersion.FileSize,
                fileHash = $"sha256:{latestVersion.FileHash}",
                isForced = latestVersion.IsForced,
                releaseNotes = latestVersion.ReleaseNotes,
                releaseDate = latestVersion.ReleaseDate.ToString("yyyy-MM-dd"),
                minCompatibleVersion = latestVersion.MinCompatibleVersion
            };
            
            return Ok(response);
        }
        catch (Exception ex)
        {
            return StatusCode(500, new { error = "Internal server error" });
        }
    }
}
```

## ğŸ”’ æ–‡ä»¶å®Œæ•´æ€§éªŒè¯

### 1. æ”¯æŒçš„å“ˆå¸Œç®—æ³•

ç³»ç»Ÿæ”¯æŒä»¥ä¸‹å“ˆå¸Œç®—æ³•è¿›è¡Œæ–‡ä»¶å®Œæ•´æ€§éªŒè¯ï¼š

- **SHA-256**ï¼ˆæ¨èï¼‰ï¼š`sha256:hash_value`
- **SHA-1**ï¼š`sha1:hash_value`
- **MD5**ï¼š`md5:hash_value`

### 2. å“ˆå¸Œå€¼ç”Ÿæˆ

#### Windows PowerShell
```powershell
# SHA-256
Get-FileHash YourPlugin-v1.1.0.zip -Algorithm SHA256

# MD5
Get-FileHash YourPlugin-v1.1.0.zip -Algorithm MD5
```

#### Linux/macOS
```bash
# SHA-256
sha256sum YourPlugin-v1.1.0.zip

# MD5
md5sum YourPlugin-v1.1.0.zip
```

#### C# ä»£ç ç¤ºä¾‹
```csharp
using System.Security.Cryptography;

public static string CalculateSHA256(string filePath)
{
    using (var stream = File.OpenRead(filePath))
    using (var sha256 = SHA256.Create())
    {
        var hash = sha256.ComputeHash(stream);
        return BitConverter.ToString(hash).Replace("-", "").ToLowerInvariant();
    }
}
```

## ğŸ“¦ æ›´æ–°åŒ…åˆ¶ä½œ

### 1. å…¨é‡æ›´æ–°åŒ…ç»“æ„

```
YourPlugin-v1.1.0.zip
â”œâ”€â”€ YourPlugin.dll          # ä¸»ç¨‹åºé›†
â”œâ”€â”€ manifest.json           # æ’ä»¶æ¸…å•
â”œâ”€â”€ icon.png               # æ’ä»¶å›¾æ ‡
â”œâ”€â”€ Dependencies/          # ä¾èµ–é¡¹
â”‚   â”œâ”€â”€ Library1.dll
â”‚   â””â”€â”€ Library2.dll
â””â”€â”€ Resources/            # èµ„æºæ–‡ä»¶
    â””â”€â”€ config.json
```

### 2. è‡ªåŠ¨åŒ–æ„å»ºè„šæœ¬

#### PowerShell è„šæœ¬
```powershell
param(
    [Parameter(Mandatory=$true)]
    [string]$Version,
    
    [Parameter(Mandatory=$true)]
    [string]$ProjectPath,
    
    [Parameter(Mandatory=$true)]
    [string]$UpdateJsonPath
)

# æ„å»ºé¡¹ç›®
dotnet build $ProjectPath -c Release

# åˆ›å»ºæ›´æ–°åŒ…
$outputPath = ".\releases\YourPlugin-v$Version.zip"
$sourcePath = ".\bin\Release\net481\*"

Compress-Archive -Path $sourcePath -DestinationPath $outputPath -Force

# è®¡ç®—å“ˆå¸Œå€¼
$fileInfo = Get-Item $outputPath
$hash = Get-FileHash $outputPath -Algorithm SHA256

# æ›´æ–°JSONæ–‡ä»¶
$updateInfo = @{
    latestVersion = $Version
    downloadUrl = "https://yourserver.com/downloads/YourPlugin-v$Version.zip"
    updateMode = "full"
    fileSize = $fileInfo.Length
    fileHash = "sha256:$($hash.Hash.ToLower())"
    isForced = $false
    releaseNotes = "è¯·æ›´æ–°æ­¤å¤„çš„å‘å¸ƒè¯´æ˜"
    releaseDate = (Get-Date).ToString("yyyy-MM-dd")
    minCompatibleVersion = "1.0.0"
}

$updateInfo | ConvertTo-Json -Depth 10 | Set-Content $UpdateJsonPath -Encoding UTF8

Write-Host "æ›´æ–°åŒ…å·²åˆ›å»º: $outputPath"
Write-Host "æ›´æ–°ä¿¡æ¯å·²ä¿å­˜: $UpdateJsonPath"
```

## ğŸŒ ä¸‹è½½URLçµæ´»æ€§

æ’ä»¶æ›´æ–°ç³»ç»Ÿæ”¯æŒä»ä»»æ„URLä¸‹è½½æ›´æ–°åŒ…ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºï¼š

- **å®˜æ–¹æœåŠ¡å™¨**ï¼š`https://yourcompany.com/downloads/plugin.zip`
- **GitHub Releases**ï¼š`https://github.com/user/repo/releases/download/v1.0/plugin.zip`
- **äº‘å­˜å‚¨æœåŠ¡**ï¼š
  - Azure Blob Storage
  - AWS S3
  - Google Cloud Storage
- **CDNæœåŠ¡**ï¼š`https://cdn.yourcompany.com/plugins/plugin.zip`
- **ç¬¬ä¸‰æ–¹æ‰˜ç®¡**ï¼šä»»ä½•æä¾›ç›´æ¥ä¸‹è½½é“¾æ¥çš„æœåŠ¡

## ğŸš€ æœ€ä½³å®è·µ

1. **ç‰ˆæœ¬å·ç®¡ç†**
   - ä½¿ç”¨è¯­ä¹‰åŒ–ç‰ˆæœ¬å·ï¼ˆä¸»ç‰ˆæœ¬.æ¬¡ç‰ˆæœ¬.ä¿®è®¢å·ï¼‰
   - ä¿æŒç‰ˆæœ¬å·çš„é€’å¢æ€§

2. **æ›´æ–°ä¿¡æ¯ç»´æŠ¤**
   - åŠæ—¶æ›´æ–° `updateInfo.json` æ–‡ä»¶
   - æä¾›è¯¦ç»†çš„å‘å¸ƒè¯´æ˜
   - ç¡®ä¿ä¸‹è½½é“¾æ¥çš„æœ‰æ•ˆæ€§

3. **å®‰å…¨æ€§è€ƒè™‘**
   - ä½¿ç”¨HTTPSåè®®ä¼ è¾“
   - å¯ç”¨æ–‡ä»¶å“ˆå¸ŒéªŒè¯
   - è€ƒè™‘ä½¿ç”¨æ•°å­—ç­¾å

4. **ç”¨æˆ·ä½“éªŒ**
   - æä¾›æ¸…æ™°çš„æ›´æ–°è¯´æ˜
   - æ”¯æŒæ›´æ–°å‰å¤‡ä»½
   - å…è®¸ç”¨æˆ·é€‰æ‹©æ›´æ–°æ—¶æœº

## ğŸ› ï¸ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æ›´æ–°æ£€æŸ¥å¤±è´¥**
   - æ£€æŸ¥ `updateUrl` æ˜¯å¦æ­£ç¡®
   - éªŒè¯æœåŠ¡å™¨è¿”å›çš„JSONæ ¼å¼
   - ç¡®è®¤ç½‘ç»œè¿æ¥æ­£å¸¸

2. **ä¸‹è½½å¤±è´¥**
   - éªŒè¯ `downloadUrl` çš„æœ‰æ•ˆæ€§
   - æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
   - ç¡®è®¤é˜²ç«å¢™è®¾ç½®

3. **å“ˆå¸ŒéªŒè¯å¤±è´¥**
   - é‡æ–°è®¡ç®—æ–‡ä»¶å“ˆå¸Œ
   - ç¡®è®¤å“ˆå¸Œç®—æ³•åŒ¹é…
   - æ£€æŸ¥æ–‡ä»¶å®Œæ•´æ€§

4. **æ–‡ä»¶å ç”¨é”™è¯¯ï¼ˆIOExceptionï¼‰**
   
   **é”™è¯¯ä¿¡æ¯**ï¼š`æ–‡ä»¶æ­£ç”±å¦ä¸€è¿›ç¨‹ä½¿ç”¨ï¼Œå› æ­¤è¯¥è¿›ç¨‹æ— æ³•è®¿é—®æ­¤æ–‡ä»¶`
   
   **åŸå› **ï¼š
   - æ’ä»¶DLLæ–‡ä»¶è¢«Excelè¿›ç¨‹é”å®š
   - å³ä½¿æ’ä»¶å¤„äºç¦ç”¨çŠ¶æ€ï¼Œæ–‡ä»¶ä»å¯èƒ½è¢«å ç”¨
   - .NET Frameworkçš„ç¨‹åºé›†åŠ è½½æœºåˆ¶å¯¼è‡´DLLæ— æ³•ç«‹å³é‡Šæ”¾
   
   **è§£å†³æ–¹æ¡ˆ**ï¼š
   
   a) **è‡ªåŠ¨é‡è¯•æœºåˆ¶**ï¼ˆå·²å®ç°ï¼‰ï¼š
   - ç³»ç»Ÿä¼šè‡ªåŠ¨é‡è¯•5æ¬¡ï¼Œæ¯æ¬¡é—´éš”1ç§’
   - é€ä¸ªæ–‡ä»¶å¤„ç†ï¼Œæé«˜æˆåŠŸç‡
   - ç§»é™¤æ–‡ä»¶çš„åªè¯»å±æ€§
   
   b) **æ‰‹åŠ¨è§£å†³æ­¥éª¤**ï¼š
   1. ä¿å­˜æ‰€æœ‰å·¥ä½œ
   2. å…³é—­Excelåº”ç”¨ç¨‹åº
   3. ç­‰å¾…å‡ ç§’é’Ÿç¡®ä¿è¿›ç¨‹å®Œå…¨é€€å‡º
   4. é‡æ–°æ‰“å¼€Excelå¹¶å°è¯•æ›´æ–°
   
   c) **é«˜çº§è§£å†³æ–¹æ¡ˆ**ï¼š
   ```powershell
   # PowerShellè„šæœ¬ - å¼ºåˆ¶ç»“æŸExcelè¿›ç¨‹
   Get-Process EXCEL -ErrorAction SilentlyContinue | Stop-Process -Force
   
   # ç­‰å¾…è¿›ç¨‹å®Œå…¨é€€å‡º
   Start-Sleep -Seconds 3
   
   # åˆ é™¤ç‰¹å®šæ’ä»¶æ–‡ä»¶ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰
   Remove-Item "C:\path\to\plugin\*.dll" -Force
   ```
   
   d) **é¢„é˜²æªæ–½**ï¼š
   - åœ¨æ›´æ–°å‰å…ˆç¦ç”¨æ’ä»¶
   - é¿å…åœ¨ä½¿ç”¨æ’ä»¶åŠŸèƒ½æ—¶è¿›è¡Œæ›´æ–°
   - è€ƒè™‘åœ¨Excelå¯åŠ¨æ—¶æ£€æŸ¥æ›´æ–°ï¼ˆæ–‡ä»¶æœªè¢«å ç”¨ï¼‰

5. **æ›´æ–°åæ’ä»¶æ— æ³•åŠ è½½**
   
   **å¯èƒ½åŸå› **ï¼š
   - ä¾èµ–é¡¹ç¼ºå¤±æˆ–ç‰ˆæœ¬ä¸åŒ¹é…
   - æ–‡ä»¶æƒé™é—®é¢˜
   - æ›´æ–°åŒ…ä¸å®Œæ•´
   
   **è§£å†³æ–¹æ¡ˆ**ï¼š
   - æ£€æŸ¥æ’ä»¶ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶æ˜¯å¦å®Œæ•´
   - ç¡®è®¤ä¾èµ–çš„DLLæ–‡ä»¶éƒ½å·²æ­£ç¡®æ›´æ–°
   - æŸ¥çœ‹Excelçš„æ’ä»¶åŠ è½½æ—¥å¿—
   - å°è¯•æ‰‹åŠ¨é‡æ–°åŠ è½½æ’ä»¶

### æ›´æ–°æœ€ä½³å®è·µ

1. **é€‰æ‹©åˆé€‚çš„æ›´æ–°æ—¶æœº**
   - åœ¨Excelåˆšå¯åŠ¨æ—¶è¿›è¡Œæ›´æ–°æ£€æŸ¥
   - é¿å…åœ¨å¤§é‡ä½¿ç”¨æ’ä»¶åŠŸèƒ½æ—¶æ›´æ–°
   - æä¾›"ç¨åæé†’"é€‰é¡¹

2. **å¤‡ä»½æœºåˆ¶**
   - æ›´æ–°å‰è‡ªåŠ¨å¤‡ä»½å½“å‰ç‰ˆæœ¬
   - ä¿ç•™æœ€è¿‘çš„å‡ ä¸ªç‰ˆæœ¬ä»¥ä¾¿å›æ»š
   - æä¾›æ¢å¤é€‰é¡¹

3. **ç”¨æˆ·ä½“éªŒä¼˜åŒ–**
   - æ˜¾ç¤ºè¯¦ç»†çš„æ›´æ–°è¿›åº¦
   - æä¾›å–æ¶ˆæ›´æ–°çš„é€‰é¡¹
   - æ›´æ–°å¤±è´¥æ—¶ç»™å‡ºæ˜ç¡®çš„é”™è¯¯ä¿¡æ¯å’Œè§£å†³å»ºè®®

4. **æµ‹è¯•å»ºè®®**
   - åœ¨å¼€å‘ç¯å¢ƒå……åˆ†æµ‹è¯•æ›´æ–°æµç¨‹
   - æ¨¡æ‹Ÿå„ç§å¼‚å¸¸æƒ…å†µï¼ˆæ–‡ä»¶å ç”¨ã€ç½‘ç»œä¸­æ–­ç­‰ï¼‰
   - å‡†å¤‡å›æ»šæ–¹æ¡ˆ

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·ï¼š
1. æŸ¥çœ‹æ’ä»¶æ—¥å¿—è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯
2. æ£€æŸ¥ç½‘ç»œè¿æ¥å’ŒæœåŠ¡å™¨é…ç½®
3. éªŒè¯JSONå“åº”æ ¼å¼æ˜¯å¦æ­£ç¡®
4. è®¿é—® [å®˜æ–¹æ–‡æ¡£](https://www.90le.cn) è·å–å¸®åŠ©
5. è”ç³»æŠ€æœ¯æ”¯æŒï¼š767759678@qq.com

---

**ç¥æ‚¨çš„æ’ä»¶æ›´æ–°åŠŸèƒ½é…ç½®é¡ºåˆ©ï¼** ğŸ‰ 