# BasePlugin 日志测试功能

## 📋 概述

BasePlugin 现在包含了完整的日志测试功能，可以演示和测试所有类型的日志输出。这些功能对于理解日志系统的工作原理和调试插件问题非常有用。

## 🚀 新增功能

### 1. 日志测试 (test_logging)

**功能描述**: 综合测试所有类型的日志输出功能

**测试内容**:
- ✅ **Debug 日志**: 详细的调试信息和程序执行状态
- ✅ **Info 日志**: 常规操作信息和状态报告  
- ✅ **Warning 日志**: 警告信息和潜在问题提示
- ✅ **Error 日志**: 错误信息和异常处理演示
- ✅ **性能测量**: 嵌套性能测量功能演示
- ✅ **格式化输出**: 参数化日志消息演示

**使用方法**:
1. 在 Excel 功能区找到"示例功能"菜单
2. 点击"日志测试"
3. 功能将自动执行各种日志测试
4. 打开日志管理器查看详细输出

### 2. 复杂数据处理示例 (complex_data_processing)

**功能描述**: 演示实际工作场景中的详细日志记录

**处理流程**:
1. **数据验证阶段**: 检查工作簿和工作表状态
2. **数据生成阶段**: 创建示例数据集
3. **数据分析阶段**: 分析数据并识别异常
4. **结果输出阶段**: 将分析结果写入工作表

**日志特点**:
- 分阶段性能测量
- 详细的操作步骤记录
- 数据验证和异常检测
- 完整的错误处理链

### 3. 错误模拟 (error_simulation)

**功能描述**: 模拟各种错误情况并演示错误日志记录

**错误类型**:
- **可恢复错误**: 网络超时、重试机制
- **严重错误**: 空引用、内存不足、权限问题

**测试场景**:
- 自动重试机制
- 分类错误处理
- 详细的异常信息记录
- 用户友好的错误消息

## 📊 日志输出示例

### Debug 日志
```
[DEBUG] 调试信息示例 - 当前时间: 14:30:15.123, 线程ID: 1
[DEBUG] 处理步骤 3/5: 正在处理数据批次
[DEBUG] 已生成 6/10 行数据
```

### Info 日志
```
[INFO] === 开始日志系统测试 ===
[INFO] 用户触发了日志测试功能，Excel版本: 16.0
[INFO] 数据分析结果 - 正常: 7, 异常: 3, 平均值: 52.40
```

### Warning 日志
```
[WARNING] 检测到内存使用率较高: 87%
[WARNING] 步骤 3: 检测到数据质量问题，但继续处理
[WARNING] 发现异常数据 - 行: 5, 值: 89
```

### Error 日志
```
[ERROR] 捕获到模拟异常，错误代码: ERR_001
Exception: System.InvalidOperationException
Message: 这是一个模拟的错误，用于测试错误日志记录
StackTrace: ...
```

### 性能测量
```
[DEBUG] 开始执行: 日志系统全面测试
[INFO] 完成执行: 复杂计算操作, 耗时: 45ms
[INFO] 完成执行: 日志系统全面测试, 耗时: 1247ms
```

## 🔧 使用建议

### 开发时
1. **使用日志测试功能**了解不同日志级别的输出效果
2. **参考复杂数据处理示例**学习如何在实际业务流程中集成日志
3. **运行错误模拟**了解异常情况下的日志处理

### 调试时
1. 在日志管理器中按插件筛选，只查看BasePlugin的日志
2. 使用级别筛选，专注于Error和Warning级别的问题
3. 利用搜索功能快速定位特定的操作或错误

### 生产环境
1. 关注Warning和Error级别的日志
2. 定期检查性能测量数据
3. 建立日志监控和告警机制

## 📝 代码示例

### 基本日志记录
```csharp
// 在功能开始时
_logger.Info("开始执行用户操作: {0}", operationName);

// 调试信息
_logger.Debug("当前处理状态: {0}, 进度: {1}%", status, progress);

// 警告信息
if (dataQualityIssue)
{
    _logger.Warning("数据质量问题: {0}，但继续处理", issue);
}

// 错误处理
try
{
    // 业务逻辑
}
catch (Exception ex)
{
    _logger.Error(ex, "操作失败: {0}", operationName);
    throw;
}
```

### 性能测量
```csharp
using (_logger.MeasurePerformance("数据处理操作"))
{
    // 需要测量性能的代码
    ProcessData();
}
```

## 🎯 最佳实践

1. **日志级别选择**:
   - Debug: 详细的程序执行信息
   - Info: 用户操作和系统状态
   - Warning: 需要注意但不影响功能的问题
   - Error: 影响功能正常运行的错误

2. **消息格式**:
   - 使用清晰、简洁的描述
   - 包含必要的上下文信息
   - 使用参数化消息提高性能

3. **性能测量**:
   - 对关键操作进行性能测量
   - 使用using语句确保正确释放资源
   - 避免过度测量影响性能

4. **错误处理**:
   - 记录完整的异常信息
   - 提供有意义的错误上下文
   - 区分可恢复和不可恢复的错误

---

通过这些日志测试功能，您可以全面了解BasePlugin的日志系统能力，并将其应用到您自己的插件开发中。 